📘 授業データベース化 要求仕様（まとめ）
1. 目的

大学の授業情報が記載された Excel（科目概要一覧）をデータベース化し、
SQLite に保存することで、

教室

曜日

時限

担当教員

講義カテゴリ（区分）

履修年次

必修/選択

学期（1学期・2学期）

などで検索可能にすることを目的とする。

Excel は人間向けにレイアウトされており、データとしては整形が必要。

2. ソースデータ（Excel）の特徴

6行目（index=5）が実質のヘッダー

セル結合や複数行の記載が多く、表形式としては不正規

特に以下の列は複雑：

曜時限・教室

担当教員

3. データ変換ルール
3.1 曜日

日本語1文字を曜日として認識：

月 火 水 木 金 土 日

3.2 時限の表記パターン（すべて対応すること）

例：

表記	意味
3	3限
3・4 / 3･4	3限と4限
4.5	4限と5限
34	3限と4限
3-5	3〜5限
5集中（例外扱い）	時限なし（remarks に入れる）
→ 上記パターンをすべて展開し、

（曜日 × 各時限）を1行ずつ記録する

4. 教室の扱い

複数の教室が列挙される場合：

201
202


などは → 別行として展開

また以下の語を "room" として扱う：

工房

プレゼンルーム

409, 410 など複数行の場合も展開

113他 → room="113", remarks="他"

5. 特殊ワード（曜日なし）

曜日・時限を持たない行（以下を含む行）は、
remarks に格納し、day / period / room は NULL にする。

該当語：

集中

隔週

指導教員の指示による

1学期

2学期

他（113他 の場合）

6. 担当教員

複数教員が以下の区切りで書かれるため、すべて分割：

, 、 ， / ・ ･ 改行


結果として：

course_id = X
instructor = "田中"
course_id = X
instructor = "佐藤"


のように複数行で保存する。

7. 最終データベース構造（SQLite）
7.1 courses（科目本体）
id (PK)
category
code
title
credits
grade
required_or_choice
semester
description
note

7.2 course_times（曜日・時限・教室・備考）
id (PK)
course_id (FK → courses.id)
day      ← 月/火/水/…
period   ← 1/2/3/…
room     ← 201 / 工房 / プレゼンルーム etc
remarks  ← 「集中」「隔週」「他」「1学期」「2学期」など


1科目が複数曜日・複数時限・複数教室を持つ場合、
→ すべて展開して複数行にする

7.3 course_instructors（担当教員一覧）
id (PK)
course_id (FK)
instructor


複数教員なら複数行で保存

8. 検索要件
以下の条件で自由に検索できる想定：

曜日（例：水曜の授業）

時限（例：3限の授業）

曜日 × 時限（例：火曜4限）

教室（例：工房で行う授業）

担当教員（例：後藤啓光が担当）

category（例：専門基礎教育科目）

学期（例：1学期授業）

複数条件の AND/OR 検索

9. 実装仕様（Python）
主な要件：

pandas で Excel 読み込み

5行目をヘッダーとして設定

曜日・時限・教室のパースロジックを実装

特殊語の処理を実装

SQLite を作成し、3テーブルに分離して保存

生成物：
courses.db
├─ courses
├─ course_times
└─ course_instructors

10. 提供した最終 Python コード

main.py（完全版）

ローカルで実行可能

SQLite の正規化・展開もすべて含む

✔ まとめ

あなたが求めた要求は：

Excel の複雑な授業情報を正規化

曜日・時限の全展開

複数教室・複数教員の対応

集中・隔週などの特例処理

SQLite に 3テーブル構造で保存

後から自由に検索できるようにする

という形で、データクレンジング＋整形＋正規化までを
完全自動化可能にしたデータ処理システムです。